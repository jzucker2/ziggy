services:
  ziggy:
    build: .
    container_name: ziggy
    ports:
      - "8000:8000"
    environment:
      - ENVIRONMENT=production
      - LOG_LEVEL=${LOG_LEVEL}
      - LOG_FORMAT=default
      - LOG_HANDLERS=console
      - LOG_FILE=logs/app.log
      - LOG_MAX_BYTES=10485760
      - LOG_BACKUP_COUNT=5
      - ACCESS_LOG=true
      # MQTT Configuration
      - MQTT_ENABLED=true
      - MQTT_BROKER_HOST=${MQTT_BROKER_HOST}
      - MQTT_BROKER_PORT=${MQTT_BROKER_PORT}
      - MQTT_USERNAME=${MQTT_USERNAME}
      - MQTT_PASSWORD=${MQTT_PASSWORD}
      - ZIGBEE2MQTT_HEALTH_TOPIC=${ZIGBEE2MQTT_HEALTH_TOPIC}
      - ZIGBEE2MQTT_BRIDGE_NAME=${ZIGBEE2MQTT_BRIDGE_NAME}
      - MQTT_CLIENT_ID=ziggy
    # Uncomment to persist logs
    # volumes:
    #   - ./logs:/app/logs
    restart: unless-stopped
